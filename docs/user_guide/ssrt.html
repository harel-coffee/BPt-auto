
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predict Stop Signal Response Time (SSRT) &#8212; BPt 2.2.3 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/getting_started.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pandas.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Predict Waist Circumference with Diffusion Weighted Imaging" href="waist_cm.html" />
    <link rel="prev" title="Predicting Substance Dependence from Multi-Site Data" href="dep_full_example.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/red_logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation/index.html">
  Installation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../options/index.html">
  Default Options
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../change_log/index.html">
  Change Log
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../cite/index.html">
  Cite BPt
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/sahahn/BPt" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/SageHahn11" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="why_bpt.html">
   Why BPt?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loading_data.html">
   Loading Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="saving_data.html">
   Saving Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test_split.html">
   Test Split
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="role.html">
   Role
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scope.html">
   Scope
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="data_files.html">
   Data Files
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="load_timeseries_example.html">
     Loading Fake Timeseries Surface Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subjects.html">
   Subjects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pipeline_objects.html">
   Pipeline Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="params.html">
   Params
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extra_params.html">
   Extra Params
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bmi_full_example.html">
   Predict BMI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dep_full_example.html">
   Predicting Substance Dependence from Multi-Site Data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Predict Stop Signal Response Time (SSRT)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="waist_cm.html">
   Predict Waist Circumference with Diffusion Weighted Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sex.html">
   Predict Sex
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-Data">
   Loading Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Define-a-train-test-split">
   Define a train-test split
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Define-an-ML-Pipeline">
   Define an ML Pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Evaluating-an-ML-Pipeline">
   Evaluating an ML Pipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Comparing-different-pipelines">
   Comparing different pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Using-the-Test-Set">
   Using the Test Set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Plotting-results">
   Plotting results
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Predict-Stop-Signal-Response-Time-(SSRT)">
<h1>Predict Stop Signal Response Time (SSRT)<a class="headerlink" href="#Predict-Stop-Signal-Response-Time-(SSRT)" title="Permalink to this headline">#</a></h1>
<p>This notebook uses stop signal task fMRI data derived contrasts from the ABCD study to predict stop signal response time (SSRT). This is an example of a regression type machine learning, and additionally includes an extra example of how to plot ROIs feature importance on brain surfaces from nilearn.</p>
<section id="Loading-Data">
<h2>Loading Data<a class="headerlink" href="#Loading-Data" title="Permalink to this headline">#</a></h2>
<p>We will be loading data from is essentially a big csv file with all the different columns, some slightly processed, from the ABCD DEAP rds (saved r dataframe). The benefit of this approach is that while a little slow, we can just load any column of interest easily as a dataframe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">BPt</span> <span class="k">as</span> <span class="nn">bp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_from_rds</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">eventname</span><span class="o">=</span><span class="s1">&#39;baseline_year_1_arm_1&#39;</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nda_rds_201.csv&#39;</span><span class="p">,</span>
                       <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;src_subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;eventname&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">names</span><span class="p">,</span>
                       <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;777&#39;</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="s1">&#39;999&#39;</span><span class="p">,</span> <span class="mi">777</span><span class="p">])</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;eventname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">eventname</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;src_subject_id&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;eventname&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This way we can look at all column avaliable</span>
<span class="n">all_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nda_rds_201.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">all_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;subjectid&#39;,
 &#39;src_subject_id&#39;,
 &#39;eventname&#39;,
 &#39;anthro_1_height_in&#39;,
 &#39;anthro_2_height_in&#39;,
 &#39;anthro_3_height_in&#39;,
 &#39;anthro_height_calc&#39;,
 &#39;anthro_weight_cast&#39;,
 &#39;anthro_weight_a_location&#39;,
 &#39;anthro_weight1_lb&#39;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use python list comprehensions to get lists of the column names of interest</span>
<span class="n">contrasts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tfmri_sst_all_correct.go.vs.fixation_beta_&#39;</span><span class="p">,</span>
             <span class="s1">&#39;tfmri_sst_all_correct.stop.vs.correct.go_beta_&#39;</span><span class="p">,</span>
             <span class="s1">&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;</span><span class="p">]</span>


<span class="n">parcs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.destrieux&#39;</span><span class="p">,</span> <span class="s1">&#39;_subcort.aseg&#39;</span><span class="p">]</span>

<span class="n">data_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_cols</span>
             <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ct</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">contrasts</span> <span class="k">if</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">col</span><span class="p">])</span>
             <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parcs</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">col</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span>
<span class="n">target_col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tfmri_sst_all_beh_total_mean.rt&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the actual data from the saved csv</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">load_from_rds</span><span class="p">(</span><span class="n">data_cols</span> <span class="o">+</span> <span class="n">target_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast from a dataframe to BPt Dataset class</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Obsificate subject ID for public example</span>
<span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

<span class="c1"># Set optional verbosity of</span>
<span class="n">data</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_cols</span><span class="p">(</span><span class="n">exclusions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.ventricle&#39;</span><span class="p">,</span> <span class="s1">&#39;_csf&#39;</span><span class="p">,</span> <span class="s1">&#39;.white.matter&#39;</span><span class="p">],</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;_subcort.aseg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 27 Columns
</pre></div></div>
</div>
<p>Data in BPt can have one of three roles, these are ‘data’ by default, ‘target’ for variable to predict, and ‘non input’ for variables which we don’t use directly as input features. We set ‘sex’ as non input in this example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_role</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;non input&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_role</span><span class="p">(</span><span class="n">target_col</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 6 Rows
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="float: left; padding: 10px;">
        <h3>Data</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.frontomargin.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.frontomargin.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.occipital.inf.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.occipital.inf.rh</th>
      <th>...</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_inf.lat.vent.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_inf.lat.vent.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_pallidum.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_pallidum.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.rh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.168032</td>
      <td>0.153849</td>
      <td>0.045860</td>
      <td>0.023883</td>
      <td>0.081824</td>
      <td>0.015926</td>
      <td>0.142664</td>
      <td>0.035705</td>
      <td>-0.169860</td>
      <td>-0.128688</td>
      <td>...</td>
      <td>-0.036716</td>
      <td>0.052883</td>
      <td>-0.006478</td>
      <td>-0.025535</td>
      <td>0.030901</td>
      <td>-0.022286</td>
      <td>0.091828</td>
      <td>0.158497</td>
      <td>0.101536</td>
      <td>0.234851</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.052402</td>
      <td>0.101880</td>
      <td>0.111399</td>
      <td>0.124650</td>
      <td>0.113433</td>
      <td>0.125727</td>
      <td>0.579317</td>
      <td>0.611870</td>
      <td>0.224255</td>
      <td>0.343618</td>
      <td>...</td>
      <td>-0.070160</td>
      <td>0.097003</td>
      <td>0.026871</td>
      <td>0.191424</td>
      <td>0.026224</td>
      <td>0.036808</td>
      <td>0.091165</td>
      <td>0.044027</td>
      <td>0.071074</td>
      <td>0.042021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.092771</td>
      <td>0.007574</td>
      <td>0.182024</td>
      <td>0.115439</td>
      <td>0.096595</td>
      <td>0.096851</td>
      <td>0.289666</td>
      <td>-0.129820</td>
      <td>0.188761</td>
      <td>0.178344</td>
      <td>...</td>
      <td>0.342260</td>
      <td>-0.114128</td>
      <td>-0.097753</td>
      <td>-0.082544</td>
      <td>-0.145369</td>
      <td>-0.187083</td>
      <td>-0.159170</td>
      <td>-0.113892</td>
      <td>-0.242210</td>
      <td>-0.175904</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.144128</td>
      <td>-0.074626</td>
      <td>-0.001618</td>
      <td>0.142387</td>
      <td>0.241128</td>
      <td>0.227172</td>
      <td>-0.141231</td>
      <td>0.475396</td>
      <td>0.573906</td>
      <td>1.363352</td>
      <td>...</td>
      <td>-0.183606</td>
      <td>-0.118741</td>
      <td>-0.055955</td>
      <td>0.046954</td>
      <td>-0.018277</td>
      <td>0.092319</td>
      <td>0.053306</td>
      <td>0.060963</td>
      <td>0.116601</td>
      <td>-0.102220</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>-0.103273</td>
      <td>-0.060990</td>
      <td>0.008791</td>
      <td>0.186439</td>
      <td>0.059300</td>
      <td>0.047829</td>
      <td>0.130752</td>
      <td>0.184572</td>
      <td>0.100078</td>
      <td>0.049040</td>
      <td>...</td>
      <td>0.010403</td>
      <td>-0.149049</td>
      <td>-0.024082</td>
      <td>0.016314</td>
      <td>-0.045987</td>
      <td>-0.090321</td>
      <td>0.066490</td>
      <td>0.055350</td>
      <td>0.022404</td>
      <td>0.095318</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>-0.060443</td>
      <td>-0.123368</td>
      <td>-0.024308</td>
      <td>-0.122978</td>
      <td>-0.143336</td>
      <td>-0.098973</td>
      <td>0.327409</td>
      <td>0.055603</td>
      <td>-0.203490</td>
      <td>-0.129804</td>
      <td>...</td>
      <td>-0.168353</td>
      <td>0.058014</td>
      <td>-0.080418</td>
      <td>0.080907</td>
      <td>-0.095893</td>
      <td>-0.069077</td>
      <td>0.009947</td>
      <td>0.034421</td>
      <td>0.007450</td>
      <td>-0.075879</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>0.012809</td>
      <td>0.010143</td>
      <td>0.012343</td>
      <td>-0.006711</td>
      <td>-0.072679</td>
      <td>-0.084823</td>
      <td>-0.203417</td>
      <td>-0.210167</td>
      <td>-0.270940</td>
      <td>-0.143613</td>
      <td>...</td>
      <td>-0.044618</td>
      <td>0.116003</td>
      <td>0.264322</td>
      <td>0.134182</td>
      <td>0.323175</td>
      <td>0.366650</td>
      <td>0.254944</td>
      <td>0.388157</td>
      <td>0.411429</td>
      <td>0.312342</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>0.164396</td>
      <td>0.202513</td>
      <td>0.376726</td>
      <td>0.257396</td>
      <td>0.371823</td>
      <td>0.123384</td>
      <td>0.507308</td>
      <td>0.788963</td>
      <td>0.260868</td>
      <td>0.246349</td>
      <td>...</td>
      <td>0.538963</td>
      <td>-0.930948</td>
      <td>-0.225716</td>
      <td>-0.347940</td>
      <td>-0.305339</td>
      <td>-0.380956</td>
      <td>-0.123154</td>
      <td>-0.251212</td>
      <td>-0.270063</td>
      <td>-0.336481</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>0.116179</td>
      <td>0.136342</td>
      <td>-0.045182</td>
      <td>0.180420</td>
      <td>0.341190</td>
      <td>-0.183304</td>
      <td>0.914101</td>
      <td>1.593521</td>
      <td>0.295187</td>
      <td>2.117747</td>
      <td>...</td>
      <td>-0.322345</td>
      <td>-0.053627</td>
      <td>0.089375</td>
      <td>-0.217486</td>
      <td>-0.092425</td>
      <td>-0.142340</td>
      <td>0.049234</td>
      <td>-0.110444</td>
      <td>0.205795</td>
      <td>0.036157</td>
    </tr>
  </tbody>
</table>
<p>11869 rows × 507 columns</p>
</div></div>
<div style="float: left; padding: 10px;">
        <h3>Target</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tfmri_sst_all_beh_total_mean.rt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>303.070588</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>207.210728</td>
    </tr>
    <tr>
      <th>3</th>
      <td>241.179775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>391.927948</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>169.889647</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>335.764988</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>332.246959</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>358.591304</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>210.954955</td>
    </tr>
  </tbody>
</table>
<p>11869 rows × 1 columns</p>
</div></div>
<div style="float: left; padding: 10px;">
        <h3>Non Input</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>M</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>F</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>F</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>F</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>F</td>
    </tr>
  </tbody>
</table>
<p>11869 rows × 1 columns</p>
</div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast sex as a binary variable</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0        0
1        0
2        1
3        1
4        1
        ..
11870    1
11871    0
11872    0
11873    0
11874    0
Name: sex, Length: 11869, dtype: category
Categories (2, int64): [0 &lt; 1]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s drop all missing data</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(8847, 509)
</pre></div></div>
</div>
<p>We can filter outliers from the data columns but also the target columns, essentially every ‘float’ type column.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filter_outliers_by_std</span><span class="p">(</span><span class="n">n_std</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 327 Rows
</pre></div></div>
</div>
<p>We can also plot individual variables</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">subjects</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">decode_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sex: 8520 rows
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_15_1.png" src="../_images/user_guide_ssrt_15_1.png" />
</div>
</div>
</section>
<section id="Define-a-train-test-split">
<h2>Define a train-test split<a class="headerlink" href="#Define-a-train-test-split" title="Permalink to this headline">#</a></h2>
<p>What if we wanted to define a train-test split? But also do it according to some criteria, say stratifying by sex?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First define a CVStrategy that says stratify by sex</span>
<span class="n">sex_strat</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">CVStrategy</span><span class="p">(</span><span class="n">stratify</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span>
<span class="n">sex_strat</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CVStrategy(stratify=&#39;sex&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the test_split</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_test_split</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">cv_strategy</span><span class="o">=</span><span class="n">sex_strat</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Performing test split on: 8520 subjects.
random_state: 2
Test split size: 0.2

Performed train/test split
Train size: 6816
Test size:  1704
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="float: left; padding: 10px;">
        <h3>Data</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.frontomargin.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.frontomargin.rh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.occipital.inf.lh</th>
      <th>tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.occipital.inf.rh</th>
      <th>...</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_inf.lat.vent.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_inf.lat.vent.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_pallidum.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_pallidum.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.rh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.lh</th>
      <th>tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.rh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">0</th>
      <td>0.168032</td>
      <td>0.153849</td>
      <td>0.045860</td>
      <td>0.023883</td>
      <td>0.081824</td>
      <td>0.015926</td>
      <td>0.142664</td>
      <td>0.035705</td>
      <td>-0.169860</td>
      <td>-0.128688</td>
      <td>...</td>
      <td>-0.036716</td>
      <td>0.052883</td>
      <td>-0.006478</td>
      <td>-0.025535</td>
      <td>0.030901</td>
      <td>-0.022286</td>
      <td>0.091828</td>
      <td>0.158497</td>
      <td>0.101536</td>
      <td>0.234851</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">2</th>
      <td>0.052402</td>
      <td>0.101880</td>
      <td>0.111399</td>
      <td>0.124650</td>
      <td>0.113433</td>
      <td>0.125727</td>
      <td>0.579317</td>
      <td>0.611870</td>
      <td>0.224255</td>
      <td>0.343618</td>
      <td>...</td>
      <td>-0.070160</td>
      <td>0.097003</td>
      <td>0.026871</td>
      <td>0.191424</td>
      <td>0.026224</td>
      <td>0.036808</td>
      <td>0.091165</td>
      <td>0.044027</td>
      <td>0.071074</td>
      <td>0.042021</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">3</th>
      <td>-0.092771</td>
      <td>0.007574</td>
      <td>0.182024</td>
      <td>0.115439</td>
      <td>0.096595</td>
      <td>0.096851</td>
      <td>0.289666</td>
      <td>-0.129820</td>
      <td>0.188761</td>
      <td>0.178344</td>
      <td>...</td>
      <td>0.342260</td>
      <td>-0.114128</td>
      <td>-0.097753</td>
      <td>-0.082544</td>
      <td>-0.145369</td>
      <td>-0.187083</td>
      <td>-0.159170</td>
      <td>-0.113892</td>
      <td>-0.242210</td>
      <td>-0.175904</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">4</th>
      <td>-0.144128</td>
      <td>-0.074626</td>
      <td>-0.001618</td>
      <td>0.142387</td>
      <td>0.241128</td>
      <td>0.227172</td>
      <td>-0.141231</td>
      <td>0.475396</td>
      <td>0.573906</td>
      <td>1.363352</td>
      <td>...</td>
      <td>-0.183606</td>
      <td>-0.118741</td>
      <td>-0.055955</td>
      <td>0.046954</td>
      <td>-0.018277</td>
      <td>0.092319</td>
      <td>0.053306</td>
      <td>0.060963</td>
      <td>0.116601</td>
      <td>-0.102220</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">5</th>
      <td>-0.243239</td>
      <td>-0.152293</td>
      <td>-0.078217</td>
      <td>-0.061314</td>
      <td>-0.044547</td>
      <td>-0.096233</td>
      <td>0.298622</td>
      <td>-0.083202</td>
      <td>-0.082675</td>
      <td>-0.071584</td>
      <td>...</td>
      <td>0.015237</td>
      <td>0.129581</td>
      <td>0.222719</td>
      <td>0.122448</td>
      <td>0.244788</td>
      <td>0.159455</td>
      <td>0.342455</td>
      <td>0.230097</td>
      <td>0.133497</td>
      <td>0.230591</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11870</th>
      <td>-0.103273</td>
      <td>-0.060990</td>
      <td>0.008791</td>
      <td>0.186439</td>
      <td>0.059300</td>
      <td>0.047829</td>
      <td>0.130752</td>
      <td>0.184572</td>
      <td>0.100078</td>
      <td>0.049040</td>
      <td>...</td>
      <td>0.010403</td>
      <td>-0.149049</td>
      <td>-0.024082</td>
      <td>0.016314</td>
      <td>-0.045987</td>
      <td>-0.090321</td>
      <td>0.066490</td>
      <td>0.055350</td>
      <td>0.022404</td>
      <td>0.095318</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11871</th>
      <td>-0.060443</td>
      <td>-0.123368</td>
      <td>-0.024308</td>
      <td>-0.122978</td>
      <td>-0.143336</td>
      <td>-0.098973</td>
      <td>0.327409</td>
      <td>0.055603</td>
      <td>-0.203490</td>
      <td>-0.129804</td>
      <td>...</td>
      <td>-0.168353</td>
      <td>0.058014</td>
      <td>-0.080418</td>
      <td>0.080907</td>
      <td>-0.095893</td>
      <td>-0.069077</td>
      <td>0.009947</td>
      <td>0.034421</td>
      <td>0.007450</td>
      <td>-0.075879</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">11872</th>
      <td>0.012809</td>
      <td>0.010143</td>
      <td>0.012343</td>
      <td>-0.006711</td>
      <td>-0.072679</td>
      <td>-0.084823</td>
      <td>-0.203417</td>
      <td>-0.210167</td>
      <td>-0.270940</td>
      <td>-0.143613</td>
      <td>...</td>
      <td>-0.044618</td>
      <td>0.116003</td>
      <td>0.264322</td>
      <td>0.134182</td>
      <td>0.323175</td>
      <td>0.366650</td>
      <td>0.254944</td>
      <td>0.388157</td>
      <td>0.411429</td>
      <td>0.312342</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11873</th>
      <td>0.164396</td>
      <td>0.202513</td>
      <td>0.376726</td>
      <td>0.257396</td>
      <td>0.371823</td>
      <td>0.123384</td>
      <td>0.507308</td>
      <td>0.788963</td>
      <td>0.260868</td>
      <td>0.246349</td>
      <td>...</td>
      <td>0.538963</td>
      <td>-0.930948</td>
      <td>-0.225716</td>
      <td>-0.347940</td>
      <td>-0.305339</td>
      <td>-0.380956</td>
      <td>-0.123154</td>
      <td>-0.251212</td>
      <td>-0.270063</td>
      <td>-0.336481</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11874</th>
      <td>0.116179</td>
      <td>0.136342</td>
      <td>-0.045182</td>
      <td>0.180420</td>
      <td>0.341190</td>
      <td>-0.183304</td>
      <td>0.914101</td>
      <td>1.593521</td>
      <td>0.295187</td>
      <td>2.117747</td>
      <td>...</td>
      <td>-0.322345</td>
      <td>-0.053627</td>
      <td>0.089375</td>
      <td>-0.217486</td>
      <td>-0.092425</td>
      <td>-0.142340</td>
      <td>0.049234</td>
      <td>-0.110444</td>
      <td>0.205795</td>
      <td>0.036157</td>
    </tr>
  </tbody>
</table>
<p>8520 rows × 507 columns</p>
<p style="margin-top: .35em"><span style="background: RGBA(176, 224, 230, .25)">6816 rows × 507 columns - Train Set </span></p><p style="margin-top: .35em"><span style="background: RGBA(249, 121, 93, .25)">1704 rows × 507 columns - Test Set </span></p></div></div>
<div style="float: left; padding: 10px;">
        <h3>Target</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tfmri_sst_all_beh_total_mean.rt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">0</th>
      <td>303.070588</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">2</th>
      <td>207.210728</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">3</th>
      <td>241.179775</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">4</th>
      <td>391.927948</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">5</th>
      <td>287.037037</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11870</th>
      <td>169.889647</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11871</th>
      <td>335.764988</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">11872</th>
      <td>332.246959</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11873</th>
      <td>358.591304</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11874</th>
      <td>210.954955</td>
    </tr>
  </tbody>
</table>
<p>8520 rows × 1 columns</p>
<p style="margin-top: .35em"><span style="background: RGBA(176, 224, 230, .25)">6816 rows × 1 columns - Train Set </span></p><p style="margin-top: .35em"><span style="background: RGBA(249, 121, 93, .25)">1704 rows × 1 columns - Test Set </span></p></div></div>
<div style="float: left; padding: 10px;">
        <h3>Non Input</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">0</th>
      <td>0</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">2</th>
      <td>1</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">3</th>
      <td>1</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">4</th>
      <td>1</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11870</th>
      <td>1</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11871</th>
      <td>0</td>
    </tr>
    <tr>
      <th style="background: RGBA(249, 121, 93, .25)">11872</th>
      <td>0</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11873</th>
      <td>0</td>
    </tr>
    <tr>
      <th style="background: RGBA(176, 224, 230, .25)">11874</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8520 rows × 1 columns</p>
<p style="margin-top: .35em"><span style="background: RGBA(176, 224, 230, .25)">6816 rows × 1 columns - Train Set </span></p><p style="margin-top: .35em"><span style="background: RGBA(249, 121, 93, .25)">1704 rows × 1 columns - Test Set </span></p></div></div></div>
</div>
</section>
<section id="Define-an-ML-Pipeline">
<h2>Define an ML Pipeline<a class="headerlink" href="#Define-an-ML-Pipeline" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s define a Pipeline, first by creating a series of based objects</span>

<span class="c1"># Standard Scaling</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Scaler</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>

<span class="c1"># Ridge Regression model</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Parameter search strategy,</span>
<span class="c1"># using different evolution and a custom nested</span>
<span class="c1"># CV strategy.</span>
<span class="n">search</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ParamSearch</span><span class="p">(</span><span class="n">search_type</span><span class="o">=</span><span class="s1">&#39;DE&#39;</span><span class="p">,</span>
                        <span class="n">n_iter</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                        <span class="n">cv</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">CV</span><span class="p">(</span><span class="n">splits</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                                 <span class="n">n_repeats</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">([</span><span class="n">scaler</span><span class="p">,</span> <span class="n">ridge</span><span class="p">],</span> <span class="n">param_search</span><span class="o">=</span><span class="n">search</span><span class="p">)</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Pipeline(param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy(), n_repeats=5,
                                        splits=0.5),
                                  n_iter=60, search_type=&#39;DE&#39;),
         steps=[Scaler(obj=&#39;standard&#39;), Model(obj=&#39;ridge&#39;, params=1)])
</pre></div></div>
</div>
</section>
<section id="Evaluating-an-ML-Pipeline">
<h2>Evaluating an ML Pipeline<a class="headerlink" href="#Evaluating-an-ML-Pipeline" title="Permalink to this headline">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can store some commonly used parameters in this</span>
<span class="c1"># ProblemSpec object. Though note, problem_type and scorer can both be automatically</span>
<span class="c1"># detected and set.</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ProblemSpec</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
                      <span class="n">scorer</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;explained_variance&#39;</span><span class="p">,</span> <span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">],</span>
                      <span class="n">random_state</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                      <span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                      <span class="n">subjects</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="c1"># This line is important! It says we only want to evaluate on the train set</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "14916fbf2e24447490f3e85b8666a1e2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;r2&#39;: 0.07958835201902088, &#39;explained_variance&#39;: 0.07967997124605375, &#39;neg_mean_squared_error&#39;: -6010.648630526718}
std_scores = {&#39;r2&#39;: 0.011299061390542244, &#39;explained_variance&#39;: 0.01136276831924015, &#39;neg_mean_squared_error&#39;: 69.94297102088669}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=8, problem_type=&#39;regression&#39;, random_state=51,
            scorer={&#39;explained_variance&#39;: make_scorer(explained_variance_score),
                    &#39;neg_mean_squared_error&#39;: make_scorer(mean_squared_error, greater_is_better=False),
                    &#39;r2&#39;: make_scorer(r2_score)},
            subjects=&#39;train&#39;, target=&#39;tfmri_sst_all_beh_total_mean.rt&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper to get mean feature importances, in this case beta weights</span>
<span class="n">results</span><span class="o">.</span><span class="n">get_fis</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.lh         0.076272
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.rh        -0.028153
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.lh     0.595893
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.rh    -0.645362
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.lh   -0.886834
                                                                                         ...
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.rh                3.186791
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.lh       -0.889136
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.rh       -1.596109
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.lh             -1.066655
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.rh             -1.562604
Length: 507, dtype: float32
</pre></div></div>
</div>
<p>Since a train-test split is being employed, there would at this stage likely be some sort of exploration of different pipelines. Or for example exploration with a limited feature set, i.e., what if we only want to try one of the contrasts? We can just specify a scope.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                      <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;</span><span class="p">,</span>
                      <span class="n">subjects</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a2de217e979e4c8c8782068c0f17c63c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;r2&#39;: 0.053080690090447434, &#39;explained_variance&#39;: 0.05310438223298464, &#39;neg_mean_squared_error&#39;: -6184.126688909328}
std_scores = {&#39;r2&#39;: 0.002212165117257543, &#39;explained_variance&#39;: 0.00221380524856045, &#39;neg_mean_squared_error&#39;: 64.62224791467456}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=8, problem_type=&#39;regression&#39;, random_state=51,
            scope=&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;,
            scorer={&#39;explained_variance&#39;: make_scorer(explained_variance_score),
                    &#39;neg_mean_squared_error&#39;: make_scorer(mean_squared_error, greater_is_better=False),
                    &#39;r2&#39;: make_scorer(r2_score)},
            subjects=&#39;train&#39;, target=&#39;tfmri_sst_all_beh_total_mean.rt&#39;)
</pre></div></div>
</div>
<p>Or along the same lines, we could also specify a sub-set of subects to evaluate by. We can use two custom input objects for this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sex_m</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ValueSubset</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">decode_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sex_f</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ValueSubset</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">decode_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sex_m_train</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Intersection</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">sex_m</span><span class="p">])</span>
<span class="n">sex_f_train</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Intersection</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">sex_f</span><span class="p">])</span>

<span class="c1"># Look at what this refers to explicitly</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_subjects</span><span class="p">(</span><span class="n">sex_m_train</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_subjects</span><span class="p">(</span><span class="n">sex_f_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3478, 3338)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                      <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;</span><span class="p">,</span>
                      <span class="n">subjects</span><span class="o">=</span><span class="n">sex_m_train</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "79ba9a0d5383452fba5c95acd2f206d8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;r2&#39;: 0.03486167143872121, &#39;explained_variance&#39;: 0.03659108637135574, &#39;neg_mean_squared_error&#39;: -6373.185441366256}
std_scores = {&#39;r2&#39;: 0.01002675208760915, &#39;explained_variance&#39;: 0.00893508198483108, &#39;neg_mean_squared_error&#39;: 475.44317569010366}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=8, problem_type=&#39;regression&#39;, random_state=51,
            scope=&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;,
            scorer={&#39;explained_variance&#39;: make_scorer(explained_variance_score),
                    &#39;neg_mean_squared_error&#39;: make_scorer(mean_squared_error, greater_is_better=False),
                    &#39;r2&#39;: make_scorer(r2_score)},
            subjects=Intersection([&#39;train&#39;, ValueSubset(name=sex, values=M, decode_values=True)]),
            target=&#39;tfmri_sst_all_beh_total_mean.rt&#39;)
</pre></div></div>
</div>
</section>
<section id="Comparing-different-pipelines">
<h2>Comparing different pipelines<a class="headerlink" href="#Comparing-different-pipelines" title="Permalink to this headline">#</a></h2>
<p>What if we wanted to explicitly compare results by sex? We have another special objects for that called Compare. Compare will run a seperate evaluate for each Option, where an Option represents a choice.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_subjects</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Compare</span><span class="p">([</span><span class="n">bp</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">sex_m_train</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span>
                               <span class="n">bp</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">sex_f_train</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)])</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                      <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;tfmri_sst_all_incorrect.stop.vs.correct.go_beta_&#39;</span><span class="p">,</span>
                      <span class="n">subjects</span><span class="o">=</span><span class="n">compare_subjects</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># The returned CompareDict has a special summary method</span>
<span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "86ef2131eaa84920b5278aa6b32de3a3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ba8601549774174af501cf8aaa310e5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_scores_r2</th>
      <th>mean_scores_explained_variance</th>
      <th>mean_scores_neg_mean_squared_error</th>
      <th>std_scores_r2</th>
      <th>std_scores_explained_variance</th>
      <th>std_scores_neg_mean_squared_error</th>
      <th>mean_timing_fit</th>
      <th>mean_timing_score</th>
    </tr>
    <tr>
      <th>subjects</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>M</th>
      <td>0.033538</td>
      <td>0.035266</td>
      <td>-6382.616684</td>
      <td>0.010401</td>
      <td>0.009289</td>
      <td>485.944440</td>
      <td>6.773705</td>
      <td>0.015207</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.055129</td>
      <td>0.055459</td>
      <td>-6093.100561</td>
      <td>0.011371</td>
      <td>0.011138</td>
      <td>488.356616</td>
      <td>6.585156</td>
      <td>0.016477</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Using-the-Test-Set">
<h2>Using the Test Set<a class="headerlink" href="#Using-the-Test-Set" title="Permalink to this headline">#</a></h2>
<p>While in practice you might want to explore more options with the train set first, let’s just move on to showing how we could test a final pipeline on the testing set, while training on the full train set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span>
                      <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="c1"># Use all three contrasts</span>
                      <span class="n">subjects</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="c1"># Use all subjects, not just train</span>
                      <span class="n">cv</span><span class="o">=</span><span class="s1">&#39;test&#39;</span> <span class="c1"># Special argument to train on full train and test on test</span>
                     <span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "35a2e4863b6f4571b0b9e4a973f9e3b1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;r2&#39;: 0.07868571312388695, &#39;explained_variance&#39;: 0.07878737040163775, &#39;neg_mean_squared_error&#39;: -5905.781152036047}
std_scores = {&#39;r2&#39;: 0.0, &#39;explained_variance&#39;: 0.0, &#39;neg_mean_squared_error&#39;: 0.0}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=8, problem_type=&#39;regression&#39;, random_state=51,
            scorer={&#39;explained_variance&#39;: make_scorer(explained_variance_score),
                    &#39;neg_mean_squared_error&#39;: make_scorer(mean_squared_error, greater_is_better=False),
                    &#39;r2&#39;: make_scorer(r2_score)},
            subjects=&#39;all&#39;, target=&#39;tfmri_sst_all_beh_total_mean.rt&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fis</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_fis</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fis</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.lh         0.096960
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.ant.rh        -0.067299
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.lh     0.696026
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.ant.rh    -0.732170
tfmri_sst_all_correct.go.vs.fixation_beta_cort.destrieux_g.and.s.cingul.mid.post.lh   -1.197480
                                                                                         ...
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_putamen.rh                3.734274
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.lh       -1.032871
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_thalamus.proper.rh       -2.059234
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.lh             -1.065423
tfmri_sst_all_incorrect.stop.vs.correct.go_beta_subcort.aseg_ventraldc.rh             -1.673626
Length: 507, dtype: float32
</pre></div></div>
</div>
</section>
<section id="Plotting-results">
<h2>Plotting results<a class="headerlink" href="#Plotting-results" title="Permalink to this headline">#</a></h2>
<p>To plot feature importance results we are going to use a different library avaliable at <a class="reference external" href="https://github.com/sahahn/Neuro_Plotting">https://github.com/sahahn/Neuro_Plotting</a>, in addition to the library nilearn.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_glass_brain</span><span class="p">,</span> <span class="n">plot_stat_map</span>

<span class="c1"># We will use some extra loading functions</span>
<span class="kn">from</span> <span class="nn">Neuro_Plotting.Ref</span> <span class="kn">import</span> <span class="n">SurfRef</span><span class="p">,</span> <span class="n">VolRef</span><span class="p">,</span> <span class="n">load_mapping</span><span class="p">,</span> <span class="n">save_mapping</span>
<span class="kn">from</span> <span class="nn">Neuro_Plotting.Plot</span> <span class="kn">import</span> <span class="n">Plot_Surf</span><span class="p">,</span> <span class="n">Plot_Surf_Collage</span><span class="p">,</span> <span class="n">Plot_SurfVol_Collage</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The directory where you install Neuro_Plotting</span>
<span class="n">data_dr</span> <span class="o">=</span> <span class="s1">&#39;/home/sage/Neuro_Plotting/data/&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Need as DataFrame not Series</span>
<span class="n">fis_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fis</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">fis_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>tfmri_sst_all_correct.go.vs.fixation_beta_cort...</td>
      <td>0.096960</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tfmri_sst_all_correct.go.vs.fixation_beta_cort...</td>
      <td>-0.067299</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tfmri_sst_all_correct.go.vs.fixation_beta_cort...</td>
      <td>0.696026</td>
    </tr>
    <tr>
      <th>3</th>
      <td>tfmri_sst_all_correct.go.vs.fixation_beta_cort...</td>
      <td>-0.732170</td>
    </tr>
    <tr>
      <th>4</th>
      <td>tfmri_sst_all_correct.go.vs.fixation_beta_cort...</td>
      <td>-1.197480</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>502</th>
      <td>tfmri_sst_all_incorrect.stop.vs.correct.go_bet...</td>
      <td>3.734274</td>
    </tr>
    <tr>
      <th>503</th>
      <td>tfmri_sst_all_incorrect.stop.vs.correct.go_bet...</td>
      <td>-1.032871</td>
    </tr>
    <tr>
      <th>504</th>
      <td>tfmri_sst_all_incorrect.stop.vs.correct.go_bet...</td>
      <td>-2.059234</td>
    </tr>
    <tr>
      <th>505</th>
      <td>tfmri_sst_all_incorrect.stop.vs.correct.go_bet...</td>
      <td>-1.065423</td>
    </tr>
    <tr>
      <th>506</th>
      <td>tfmri_sst_all_incorrect.stop.vs.correct.go_bet...</td>
      <td>-1.673626</td>
    </tr>
  </tbody>
</table>
<p>507 rows × 2 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">surf_ref</span> <span class="o">=</span> <span class="n">SurfRef</span><span class="p">(</span><span class="n">data_dr</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;fsaverage5&#39;</span><span class="p">,</span> <span class="n">parc</span><span class="o">=</span><span class="s1">&#39;destr&#39;</span><span class="p">)</span>

<span class="c1"># Get beta weights seperate by contrast and hemisphere</span>
<span class="n">betas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c_key</span> <span class="ow">in</span> <span class="n">contrasts</span><span class="p">:</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">surf_ref</span><span class="o">.</span><span class="n">get_hemis_plot_vals</span><span class="p">(</span><span class="n">fis_df</span><span class="p">,</span>
                                     <span class="n">lh_key</span><span class="o">=</span><span class="s1">&#39;.lh&#39;</span><span class="p">,</span>
                                     <span class="n">rh_key</span><span class="o">=</span><span class="s1">&#39;.rh&#39;</span><span class="p">,</span>
                                     <span class="n">i_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.destrieux&#39;</span><span class="p">,</span> <span class="n">c_key</span><span class="p">])</span>
    <span class="n">betas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">betas</span><span class="p">)):</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">smf</span> <span class="o">=</span> <span class="n">Plot_Surf_Collage</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">betas</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                          <span class="n">ref</span> <span class="o">=</span> <span class="n">surf_ref</span><span class="p">,</span>
                                          <span class="n">surf_mesh</span> <span class="o">=</span> <span class="s1">&#39;pial&#39;</span><span class="p">,</span>
                                          <span class="n">bg_map</span> <span class="o">=</span> <span class="s1">&#39;sulc&#39;</span><span class="p">,</span>
                                          <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                                          <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;seismic&#39;</span><span class="p">,</span>
                                          <span class="n">title</span> <span class="o">=</span> <span class="n">contrasts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                          <span class="n">title_sz</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
                                          <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                                          <span class="n">dist</span><span class="o">=</span> <span class="mf">6.25</span><span class="p">,</span>
                                          <span class="n">wspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                          <span class="n">hspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                          <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                          <span class="n">avg_method</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
                                          <span class="n">bg_on_data</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                          <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                                          <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Optionally save data</span>
    <span class="c1">#plt.savefig(contrast_keys[i] + &#39;.png&#39;, dpi=100, bbox_inches=&#39;tight&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_41_0.png" src="../_images/user_guide_ssrt_41_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_41_1.png" src="../_images/user_guide_ssrt_41_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_41_2.png" src="../_images/user_guide_ssrt_41_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ref</span> <span class="o">=</span> <span class="n">VolRef</span><span class="p">(</span><span class="n">data_dr</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;mni&#39;</span><span class="p">,</span> <span class="n">parc</span><span class="o">=</span><span class="s1">&#39;aseg_2mm&#39;</span><span class="p">)</span>

<span class="n">vols</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c_key</span> <span class="ow">in</span> <span class="n">contrasts</span><span class="p">:</span>
    <span class="n">vols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vol_ref</span><span class="o">.</span><span class="n">get_plot_vals</span><span class="p">(</span><span class="n">fis_df</span><span class="p">,</span> <span class="n">i_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_subcort.aseg&#39;</span><span class="p">,</span> <span class="n">c_key</span><span class="p">],</span> <span class="n">d_keys</span><span class="o">=</span><span class="p">[]))</span>

<span class="n">vols</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;nibabel.nifti1.Nifti1Image at 0x7f68c84e7880&gt;,
 &lt;nibabel.nifti1.Nifti1Image at 0x7f688b0250d0&gt;,
 &lt;nibabel.nifti1.Nifti1Image at 0x7f688953cbe0&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contrasts</span><span class="p">)):</span>
    <span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">vols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">contrasts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plot_stat_map</span><span class="p">(</span><span class="n">vols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">contrasts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_0.png" src="../_images/user_guide_ssrt_43_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_1.png" src="../_images/user_guide_ssrt_43_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_2.png" src="../_images/user_guide_ssrt_43_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_3.png" src="../_images/user_guide_ssrt_43_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_4.png" src="../_images/user_guide_ssrt_43_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_ssrt_43_5.png" src="../_images/user_guide_ssrt_43_5.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020-2022.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>