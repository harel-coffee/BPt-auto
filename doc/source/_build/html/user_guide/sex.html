
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Predict Sex &#8212; BPt 2 documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/getting_started.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pandas.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API reference" href="../reference/index.html" />
    <link rel="prev" title="Predict Waist Circumference with Diffusion Weighted Imaging" href="waist_cm.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/red_logo.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../installation/index.html">Installation</a>
        </li>
        
        
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">User Guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../reference/index.html">API reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../options/index.html">Default Options</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../change_log/index.html">Change Log</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/sahahn/BPt" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/SageHahn11" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="why_bpt.html">Why BPt?</a>
                </li>
            
          
            
                <li class="">
                    <a href="loading_data.html">Loading Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="saving_data.html">Saving Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="test_split.html">Test Split</a>
                </li>
            
          
            
                <li class="">
                    <a href="role.html">Role</a>
                </li>
            
          
            
                <li class="">
                    <a href="scope.html">Scope</a>
                </li>
            
          
            
                <li class="">
                    <a href="data_types.html">Data Types</a>
                </li>
            
          
            
                <li class="">
                    <a href="data_files.html">Data Files</a>
                </li>
            
          
            
                <li class="">
                    <a href="subjects.html">Subjects</a>
                </li>
            
          
            
                <li class="">
                    <a href="pipeline_objects.html">Pipeline Objects</a>
                </li>
            
          
            
                <li class="">
                    <a href="params.html">Params</a>
                </li>
            
          
            
                <li class="">
                    <a href="extra_params.html">Extra Params</a>
                </li>
            
          
            
                <li class="">
                    <a href="bmi_full_example.html">Predict BMI From Change In Brain</a>
                </li>
            
          
            
                <li class="">
                    <a href="dep_full_example.html">Predicting Substance Dependence from Multi-Site Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="ssrt.html">Predict Stop Signal Response Time (SSRT)</a>
                </li>
            
          
            
                <li class="">
                    <a href="waist_cm.html">Predict Waist Circumference with Diffusion Weighted Imaging</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Predict Sex</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Predict-Sex">
<h1>Predict Sex<a class="headerlink" href="#Predict-Sex" title="Permalink to this headline">¶</a></h1>
<p>This notebook goes through a simple binary classification example, explaining general library functionality along the way. Within this notebook we make use of data downloaded from Release 2.0.1 of the the ABCD Study (<a class="reference external" href="https://abcdstudy.org/">https://abcdstudy.org/</a>). This dataset is openly available to researchers (after signing a data use agreement) and is particularly well suited towards performing neuroimaging based ML given the large sample size of the study.</p>
<p>Within this notebook we will be performing binary classification predicting sex assigned at birth from tabular ROI structural MRI data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">BPt</span> <span class="k">as</span> <span class="nn">bp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">simplefilter</span>
<span class="kn">from</span> <span class="nn">sklearn.exceptions</span> <span class="kn">import</span> <span class="n">ConvergenceWarning</span>
<span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">ConvergenceWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">load_from_rds</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">eventname</span><span class="o">=</span><span class="s1">&#39;baseline_year_1_arm_1&#39;</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nda_rds_201.csv&#39;</span><span class="p">,</span>
                       <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;src_subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;eventname&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">names</span><span class="p">,</span>
                       <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;777&#39;</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="s1">&#39;999&#39;</span><span class="p">,</span> <span class="mi">777</span><span class="p">])</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;eventname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">eventname</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;src_subject_id&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;eventname&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Obsificate subject ID for public example</span>
    <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

    <span class="c1"># Return as pandas DataFrame cast to BPt Dataset</span>
    <span class="k">return</span> <span class="n">bp</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This way we can look at all column avaliable</span>
<span class="n">all_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nda_rds_201.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>We can search through all column to find which columns we actually want to load. We will start with the brain imaging features.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">feat_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;thick&#39;</span><span class="p">:</span> <span class="s1">&#39;smri_thick_cort.destrieux_g.&#39;</span><span class="p">,</span>
             <span class="s1">&#39;sulc&#39;</span><span class="p">:</span> <span class="s1">&#39;smri_sulc_cort.destrieux_g.&#39;</span><span class="p">,</span>
             <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s1">&#39;smri_area_cort.destrieux_g.&#39;</span><span class="p">,</span>
             <span class="s1">&#39;subcort&#39;</span><span class="p">:</span> <span class="s1">&#39;smri_vol_subcort.aseg_&#39;</span><span class="p">}</span>

<span class="n">feat_cols</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span> <span class="k">if</span> <span class="n">feat_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">feat_keys</span><span class="p">}</span>
<span class="n">all_cols</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">feat_cols</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="p">[])</span>

<span class="c1"># For example</span>
<span class="n">feat_cols</span><span class="p">[</span><span class="s1">&#39;thick&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;smri_thick_cort.destrieux_g.and.s.frontomargin.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.occipital.inf.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.paracentral.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.subcentral.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.transv.frontopol.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.cingul.ant.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.cingul.mid.ant.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.and.s.cingul.mid.post.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.cingul.post.dorsal.lh&#39;,
 &#39;smri_thick_cort.destrieux_g.cingul.post.ventral.lh&#39;]
</pre></div></div>
</div>
<p>We also need our target variable, in this case sex.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_from_rds</span><span class="p">(</span><span class="n">all_cols</span> <span class="o">+</span> <span class="p">[</span><span class="n">target</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="float: left; padding: 10px;">
        <h3>Data</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.ant.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.ant.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.ant.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.ant.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.post.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.post.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.frontomargin.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.frontomargin.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.occipital.inf.lh</th>
      <th>...</th>
      <th>smri_vol_subcort.aseg_subcorticalgrayvolume</th>
      <th>smri_vol_subcort.aseg_supratentorialvolume</th>
      <th>smri_vol_subcort.aseg_thalamus.proper.lh</th>
      <th>smri_vol_subcort.aseg_thalamus.proper.rh</th>
      <th>smri_vol_subcort.aseg_ventraldc.lh</th>
      <th>smri_vol_subcort.aseg_ventraldc.rh</th>
      <th>smri_vol_subcort.aseg_wholebrain</th>
      <th>smri_vol_subcort.aseg_wm.hypointensities</th>
      <th>smri_vol_subcort.aseg_wm.hypointensities.lh</th>
      <th>smri_vol_subcort.aseg_wm.hypointensities.rh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1540.0</td>
      <td>1921.0</td>
      <td>1237.0</td>
      <td>1211.0</td>
      <td>939.0</td>
      <td>1022.0</td>
      <td>872.0</td>
      <td>596.0</td>
      <td>820.0</td>
      <td>...</td>
      <td>54112.0</td>
      <td>9.738411e+05</td>
      <td>6980.4</td>
      <td>6806.6</td>
      <td>3448.1</td>
      <td>3372.7</td>
      <td>1.099494e+06</td>
      <td>2201.9</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M</td>
      <td>2108.0</td>
      <td>2583.0</td>
      <td>1289.0</td>
      <td>1295.0</td>
      <td>1066.0</td>
      <td>1328.0</td>
      <td>907.0</td>
      <td>843.0</td>
      <td>1571.0</td>
      <td>...</td>
      <td>71188.0</td>
      <td>1.290405e+06</td>
      <td>9091.3</td>
      <td>8105.3</td>
      <td>5058.5</td>
      <td>5261.6</td>
      <td>1.444690e+06</td>
      <td>1254.8</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>2196.0</td>
      <td>2266.0</td>
      <td>1012.0</td>
      <td>1459.0</td>
      <td>1326.0</td>
      <td>1398.0</td>
      <td>944.0</td>
      <td>924.0</td>
      <td>1209.0</td>
      <td>...</td>
      <td>61985.0</td>
      <td>1.283405e+06</td>
      <td>7470.7</td>
      <td>7278.4</td>
      <td>3924.8</td>
      <td>3983.6</td>
      <td>1.421171e+06</td>
      <td>950.9</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M</td>
      <td>1732.0</td>
      <td>1936.0</td>
      <td>1024.0</td>
      <td>916.0</td>
      <td>900.0</td>
      <td>1002.0</td>
      <td>863.0</td>
      <td>730.0</td>
      <td>969.0</td>
      <td>...</td>
      <td>61855.0</td>
      <td>1.072113e+06</td>
      <td>8152.9</td>
      <td>7436.8</td>
      <td>4085.2</td>
      <td>4129.3</td>
      <td>1.186497e+06</td>
      <td>789.9</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>M</td>
      <td>1583.0</td>
      <td>1821.0</td>
      <td>730.0</td>
      <td>1040.0</td>
      <td>709.0</td>
      <td>872.0</td>
      <td>938.0</td>
      <td>745.0</td>
      <td>789.0</td>
      <td>...</td>
      <td>59550.0</td>
      <td>1.001272e+06</td>
      <td>7993.5</td>
      <td>7239.5</td>
      <td>3899.4</td>
      <td>4024.6</td>
      <td>1.139532e+06</td>
      <td>651.7</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>F</td>
      <td>1603.0</td>
      <td>1841.0</td>
      <td>899.0</td>
      <td>1091.0</td>
      <td>990.0</td>
      <td>995.0</td>
      <td>809.0</td>
      <td>666.0</td>
      <td>1155.0</td>
      <td>...</td>
      <td>61090.0</td>
      <td>9.897016e+05</td>
      <td>7113.5</td>
      <td>6835.3</td>
      <td>4029.6</td>
      <td>3826.0</td>
      <td>1.134203e+06</td>
      <td>2304.8</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>F</td>
      <td>1862.0</td>
      <td>2245.0</td>
      <td>1406.0</td>
      <td>1502.0</td>
      <td>882.0</td>
      <td>1279.0</td>
      <td>1105.0</td>
      <td>1015.0</td>
      <td>1256.0</td>
      <td>...</td>
      <td>64413.0</td>
      <td>1.172208e+06</td>
      <td>8123.0</td>
      <td>7947.6</td>
      <td>3893.0</td>
      <td>4428.5</td>
      <td>1.301402e+06</td>
      <td>1654.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>F</td>
      <td>1803.0</td>
      <td>1888.0</td>
      <td>967.0</td>
      <td>1101.0</td>
      <td>866.0</td>
      <td>1128.0</td>
      <td>1040.0</td>
      <td>642.0</td>
      <td>939.0</td>
      <td>...</td>
      <td>55505.0</td>
      <td>1.040864e+06</td>
      <td>6923.8</td>
      <td>6459.8</td>
      <td>3502.5</td>
      <td>3674.0</td>
      <td>1.150473e+06</td>
      <td>1209.5</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>F</td>
      <td>1957.0</td>
      <td>1998.0</td>
      <td>1142.0</td>
      <td>1102.0</td>
      <td>1144.0</td>
      <td>1130.0</td>
      <td>884.0</td>
      <td>638.0</td>
      <td>1122.0</td>
      <td>...</td>
      <td>59816.0</td>
      <td>1.079887e+06</td>
      <td>7665.4</td>
      <td>5959.4</td>
      <td>3736.0</td>
      <td>4060.7</td>
      <td>1.214126e+06</td>
      <td>1321.1</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>11875 rows × 273 columns</p>
</div></div></div>
</div>
<p>Next we need to tell the dataset a few things about sex, namely that it is a binary variable, and that it is our target variable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="float: left; padding: 10px;">
        <h3>Target</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>1</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>11875 rows × 1 columns</p>
</div></div></div>
</div>
<p>Let’s look at some NaN info</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">nan_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loaded NaN Info:
There are: 94062 total missing values
223 columns found with 341 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;])
8 columns found with 342 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;])
5 columns found with 343 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;, &#39;area&#39;])
3 columns found with 384 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;])
3 columns found with 346 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;])
3 columns found with 453 missing values (column name overlap: [&#39;smri_vol_subcort.aseg_&#39;, &#39;le&#39;])
2 columns found with 387 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.and.s.&#39;, &#39;in&#39;])
2 columns found with 379 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;, &#39;.lh&#39;, &#39;an&#39;, &#39;.s&#39;])
2 columns found with 344 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;])
2 columns found with 352 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;, &#39;temp.&#39;, &#39;.lat&#39;])
2 columns found with 361 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.and.s.&#39;, &#39;ci&#39;, &#39;l.&#39;])

</pre></div></div>
</div>
<p>What happens now if we drop any subjects with more than 1% of their loaded columns with NaN values</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_subjects_by_nan</span><span class="p">(</span><span class="n">threshold</span><span class="o">=.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">nan_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Setting NaN threshold to: 2.73
Dropped 453 Rows
Loaded NaN Info:
There are: 961 total missing values
8 columns found with 1 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;])
5 columns found with 2 missing values (column name overlap: [&#39;cort.&#39;, &#39;smri_&#39;, &#39;area&#39;])
4 columns found with 5 missing values (column name overlap: [])
2 columns found with 49 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;, &#39;ra&#39;, &#39;.t&#39;, &#39;d.&#39;])
2 columns found with 46 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.and.s.&#39;, &#39;in&#39;])
2 columns found with 3 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;])
2 columns found with 43 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.and.s.&#39;, &#39;.rh&#39;, &#39;al&#39;])
2 columns found with 11 missing values (column name overlap: [&#39;smri_area_cort.destrieux_g.&#39;, &#39;temp.&#39;, &#39;.lat&#39;])

</pre></div></div>
</div>
<p>That greatly reduces the number of remaining missing values we have. Next, let’s consider outlier filtering as…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
smri_thick_cort.destrieux_g.front.middle.rh          -1.475994
smri_thick_cort.destrieux_g.temporal.middle.lh       -1.306818
smri_thick_cort.destrieux_g.precentral.rh            -1.266633
smri_thick_cort.destrieux_g.pariet.inf.angular.rh    -1.260234
smri_thick_cort.destrieux_g.temporal.middle.rh       -1.222911
                                                       ...
smri_vol_subcort.aseg_lateral.ventricle.lh            4.053670
smri_vol_subcort.aseg_lateral.ventricle.rh            4.403390
smri_area_cort.destrieux_g.cingul.post.ventral.lh     4.897899
smri_area_cort.destrieux_g.cingul.post.ventral.rh     4.898569
smri_vol_subcort.aseg_wm.hypointensities             16.250108
Length: 272, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># We don&#39;t even care about this</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_cols</span><span class="p">(</span><span class="n">exclusions</span><span class="o">=</span><span class="s1">&#39;aseg_wm.hypointensities&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 3 Columns
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filter_outliers_by_std</span><span class="p">(</span><span class="n">n_std</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 61 Rows
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sex: 11356 rows (5 NaN)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_sex_19_1.png" src="../_images/user_guide_sex_19_1.png" />
</div>
</div>
<p>Note we have some missing data in the target variable, we can drop these.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_nan_subjects</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dropped 5 Rows
</pre></div></div>
</div>
<p>Let’s split our data in a train test split.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">test_split</span><span class="p">(</span><span class="n">size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">train_data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Performing test split on: 11356 subjects.
random_state: 2
Test split size: 0.2

Performed train/test split
Train size: 9084
Test size:  2272
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="float: left; padding: 10px;">
        <h3>Data</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.ant.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.ant.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.ant.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.ant.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.post.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.cingul.mid.post.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.frontomargin.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.frontomargin.rh</th>
      <th>smri_area_cort.destrieux_g.and.s.occipital.inf.lh</th>
      <th>smri_area_cort.destrieux_g.and.s.occipital.inf.rh</th>
      <th>...</th>
      <th>smri_vol_subcort.aseg_pallidum.rh</th>
      <th>smri_vol_subcort.aseg_putamen.lh</th>
      <th>smri_vol_subcort.aseg_putamen.rh</th>
      <th>smri_vol_subcort.aseg_subcorticalgrayvolume</th>
      <th>smri_vol_subcort.aseg_supratentorialvolume</th>
      <th>smri_vol_subcort.aseg_thalamus.proper.lh</th>
      <th>smri_vol_subcort.aseg_thalamus.proper.rh</th>
      <th>smri_vol_subcort.aseg_ventraldc.lh</th>
      <th>smri_vol_subcort.aseg_ventraldc.rh</th>
      <th>smri_vol_subcort.aseg_wholebrain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1540.0</td>
      <td>1921.0</td>
      <td>1237.0</td>
      <td>1211.0</td>
      <td>939.0</td>
      <td>1022.0</td>
      <td>872.0</td>
      <td>596.0</td>
      <td>820.0</td>
      <td>839.0</td>
      <td>...</td>
      <td>1392.5</td>
      <td>5471.6</td>
      <td>5002.9</td>
      <td>54112.0</td>
      <td>9.738411e+05</td>
      <td>6980.4</td>
      <td>6806.6</td>
      <td>3448.1</td>
      <td>3372.7</td>
      <td>1.099494e+06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2108.0</td>
      <td>2583.0</td>
      <td>1289.0</td>
      <td>1295.0</td>
      <td>1066.0</td>
      <td>1328.0</td>
      <td>907.0</td>
      <td>843.0</td>
      <td>1571.0</td>
      <td>1056.0</td>
      <td>...</td>
      <td>2102.4</td>
      <td>6520.7</td>
      <td>6929.8</td>
      <td>71188.0</td>
      <td>1.290405e+06</td>
      <td>9091.3</td>
      <td>8105.3</td>
      <td>5058.5</td>
      <td>5261.6</td>
      <td>1.444690e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1732.0</td>
      <td>1936.0</td>
      <td>1024.0</td>
      <td>916.0</td>
      <td>900.0</td>
      <td>1002.0</td>
      <td>863.0</td>
      <td>730.0</td>
      <td>969.0</td>
      <td>1000.0</td>
      <td>...</td>
      <td>1715.1</td>
      <td>6078.6</td>
      <td>6013.7</td>
      <td>61855.0</td>
      <td>1.072113e+06</td>
      <td>8152.9</td>
      <td>7436.8</td>
      <td>4085.2</td>
      <td>4129.3</td>
      <td>1.186497e+06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1346.0</td>
      <td>1855.0</td>
      <td>832.0</td>
      <td>1101.0</td>
      <td>855.0</td>
      <td>930.0</td>
      <td>722.0</td>
      <td>769.0</td>
      <td>1249.0</td>
      <td>789.0</td>
      <td>...</td>
      <td>1466.2</td>
      <td>5281.3</td>
      <td>4990.4</td>
      <td>52886.0</td>
      <td>9.367869e+05</td>
      <td>6385.2</td>
      <td>5843.4</td>
      <td>3557.2</td>
      <td>3420.8</td>
      <td>1.047860e+06</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1537.0</td>
      <td>1986.0</td>
      <td>1151.0</td>
      <td>1178.0</td>
      <td>1182.0</td>
      <td>1389.0</td>
      <td>839.0</td>
      <td>678.0</td>
      <td>1250.0</td>
      <td>1207.0</td>
      <td>...</td>
      <td>1859.0</td>
      <td>6599.7</td>
      <td>6317.0</td>
      <td>65182.0</td>
      <td>1.135326e+06</td>
      <td>8437.8</td>
      <td>8259.8</td>
      <td>3734.3</td>
      <td>4159.9</td>
      <td>1.263524e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>1583.0</td>
      <td>1821.0</td>
      <td>730.0</td>
      <td>1040.0</td>
      <td>709.0</td>
      <td>872.0</td>
      <td>938.0</td>
      <td>745.0</td>
      <td>789.0</td>
      <td>825.0</td>
      <td>...</td>
      <td>1610.9</td>
      <td>6090.9</td>
      <td>5444.8</td>
      <td>59550.0</td>
      <td>1.001272e+06</td>
      <td>7993.5</td>
      <td>7239.5</td>
      <td>3899.4</td>
      <td>4024.6</td>
      <td>1.139532e+06</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>1603.0</td>
      <td>1841.0</td>
      <td>899.0</td>
      <td>1091.0</td>
      <td>990.0</td>
      <td>995.0</td>
      <td>809.0</td>
      <td>666.0</td>
      <td>1155.0</td>
      <td>844.0</td>
      <td>...</td>
      <td>1664.6</td>
      <td>7042.9</td>
      <td>6654.0</td>
      <td>61090.0</td>
      <td>9.897016e+05</td>
      <td>7113.5</td>
      <td>6835.3</td>
      <td>4029.6</td>
      <td>3826.0</td>
      <td>1.134203e+06</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>1862.0</td>
      <td>2245.0</td>
      <td>1406.0</td>
      <td>1502.0</td>
      <td>882.0</td>
      <td>1279.0</td>
      <td>1105.0</td>
      <td>1015.0</td>
      <td>1256.0</td>
      <td>960.0</td>
      <td>...</td>
      <td>1856.8</td>
      <td>6331.3</td>
      <td>6366.1</td>
      <td>64413.0</td>
      <td>1.172208e+06</td>
      <td>8123.0</td>
      <td>7947.6</td>
      <td>3893.0</td>
      <td>4428.5</td>
      <td>1.301402e+06</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>1803.0</td>
      <td>1888.0</td>
      <td>967.0</td>
      <td>1101.0</td>
      <td>866.0</td>
      <td>1128.0</td>
      <td>1040.0</td>
      <td>642.0</td>
      <td>939.0</td>
      <td>892.0</td>
      <td>...</td>
      <td>1470.9</td>
      <td>5730.4</td>
      <td>5469.3</td>
      <td>55505.0</td>
      <td>1.040864e+06</td>
      <td>6923.8</td>
      <td>6459.8</td>
      <td>3502.5</td>
      <td>3674.0</td>
      <td>1.150473e+06</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>1957.0</td>
      <td>1998.0</td>
      <td>1142.0</td>
      <td>1102.0</td>
      <td>1144.0</td>
      <td>1130.0</td>
      <td>884.0</td>
      <td>638.0</td>
      <td>1122.0</td>
      <td>819.0</td>
      <td>...</td>
      <td>1586.3</td>
      <td>6171.0</td>
      <td>5573.6</td>
      <td>59816.0</td>
      <td>1.079887e+06</td>
      <td>7665.4</td>
      <td>5959.4</td>
      <td>3736.0</td>
      <td>4060.7</td>
      <td>1.214126e+06</td>
    </tr>
  </tbody>
</table>
<p>9084 rows × 269 columns</p>
</div></div>
<div style="float: left; padding: 10px;">
        <h3>Target</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>11870</th>
      <td>1</td>
    </tr>
    <tr>
      <th>11871</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11872</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11873</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11874</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>9084 rows × 1 columns</p>
</div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ProblemSpec</span><span class="p">(</span><span class="n">scorer</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">],</span>
                    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ps</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ProblemSpec(n_jobs=16, scorer=[&#39;roc_auc&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_pipeline</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ModelPipeline</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">))</span>
<span class="n">model_pipeline</span><span class="o">.</span><span class="n">print_all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ModelPipeline
-------------
imputers=\
Imputer(obj=&#39;default&#39;)

scalers=\
Scaler(obj=&#39;standard&#39;)

model=\
Model(obj=&#39;dt&#39;)

param_search=\
None

</pre></div></div>
</div>
<p>We can see that the their are a few default values, specifically we have a set of default imputers, one for replacing all float variables with the mean value, and one for replacing all categorical / binary variables (if any, otherwise ignored) with the median values.</p>
<p>Next, we have a just standard scaler, which scales all features to have mean 0, std of 1.</p>
<p>Then, we have our decision tree.</p>
<p>Lastly, we have no param_search specified.</p>
<p>Now that we have an initial model, we are ready to use the Evaluate function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">model_pipeline</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d759f64987d34619bfddcd06e4a26e4b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;roc_auc&#39;: 0.6416069711113249}
std_scores = {&#39;roc_auc&#39;: 0.010678367090234725}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;feature_importances_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_feature_importances&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=16, problem_type=&#39;binary&#39;,
            scorer={&#39;roc_auc&#39;: make_scorer(roc_auc_score, needs_threshold=True)},
            subjects=&#39;all&#39;, target=&#39;sex&#39;)
</pre></div></div>
</div>
<p>Let’s try a just linear model now (Logistic Regression, since binary), updating our model within our model_pipeline first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_pipeline</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">model_pipeline</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b24ba47ba76247c1804f4492cc29fc4b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;roc_auc&#39;: 0.903625961725159}
std_scores = {&#39;roc_auc&#39;: 0.004037404292329663}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=16, problem_type=&#39;binary&#39;,
            scorer={&#39;roc_auc&#39;: make_scorer(roc_auc_score, needs_threshold=True)},
            subjects=&#39;all&#39;, target=&#39;sex&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span><span class="o">.</span><span class="n">get_fis</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
smri_vol_subcort.aseg_caudate.rh                   -0.645759
smri_vol_subcort.aseg_thalamus.proper.lh           -0.421250
smri_thick_cort.destrieux_g.postcentral.rh         -0.404056
smri_vol_subcort.aseg_wholebrain                   -0.376275
smri_vol_subcort.aseg_cerebellum.white.matter.rh   -0.365137
                                                      ...
smri_vol_subcort.aseg_thalamus.proper.rh            0.360649
smri_vol_subcort.aseg_putamen.rh                    0.449518
smri_vol_subcort.aseg_cerebellum.cortex.rh          0.520414
smri_vol_subcort.aseg_intracranialvolume            0.632200
smri_vol_subcort.aseg_cerebral.white.matter.rh      1.045681
Length: 269, dtype: float64
</pre></div></div>
</div>
<p>What we find here is a bit trivial. Basically just boys have bigger brains than girls … That said, this is just an example. What if we say residualize in a nested way for intracranial volume?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">BPt.extensions</span> <span class="kn">import</span> <span class="n">LinearResidualizer</span>

<span class="n">resid</span> <span class="o">=</span> <span class="n">LinearResidualizer</span><span class="p">(</span><span class="n">to_resid_df</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;smri_vol_subcort.aseg_intracranialvolume&#39;</span><span class="p">]])</span>
<span class="n">resid_scaler</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Scaler</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>


<span class="n">resid_pipeline</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">ModelPipeline</span><span class="p">(</span><span class="n">scalers</span><span class="o">=</span><span class="p">[</span><span class="n">bp</span><span class="o">.</span><span class="n">Scaler</span><span class="p">(</span><span class="s1">&#39;robust&#39;</span><span class="p">),</span> <span class="n">resid_scaler</span><span class="p">],</span>
                                  <span class="n">model</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>

<span class="n">resid_pipeline</span><span class="o">.</span><span class="n">print_all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ModelPipeline
-------------
imputers=\
Imputer(obj=&#39;default&#39;)

scalers=\
[Scaler(obj=&#39;robust&#39;),
 Scaler(obj=LinearResidualizer(to_resid_df=       smri_vol_subcort.aseg_intracranialvolume
0                                  1.354788e+06
2                                  1.703982e+06
3                                  1.679526e+06
4                                  1.561216e+06
5                                  1.415059e+06
...                                         ...
11870                              1.480336e+06
11871                              1.470497e+06
11872                              1.455727e+06
11873                              1.480286e+06
11874                              1.500072e+06

[11356 rows x 1 columns]))]

model=\
Model(obj=&#39;linear&#39;)

param_search=\
None

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">model_pipeline</span><span class="p">,</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2a6874541abe4d16a8b2ece3644cd98f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;roc_auc&#39;: 0.903625961725159}
std_scores = {&#39;roc_auc&#39;: 0.004037404292329663}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;coef_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_coef_&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=16, problem_type=&#39;binary&#39;,
            scorer={&#39;roc_auc&#39;: make_scorer(roc_auc_score, needs_threshold=True)},
            subjects=&#39;all&#39;, target=&#39;sex&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span><span class="o">.</span><span class="n">get_fis</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
smri_vol_subcort.aseg_caudate.rh                   -0.645759
smri_vol_subcort.aseg_thalamus.proper.lh           -0.421250
smri_thick_cort.destrieux_g.postcentral.rh         -0.404056
smri_vol_subcort.aseg_wholebrain                   -0.376275
smri_vol_subcort.aseg_cerebellum.white.matter.rh   -0.365137
                                                      ...
smri_vol_subcort.aseg_thalamus.proper.rh            0.360649
smri_vol_subcort.aseg_putamen.rh                    0.449518
smri_vol_subcort.aseg_cerebellum.cortex.rh          0.520414
smri_vol_subcort.aseg_intracranialvolume            0.632200
smri_vol_subcort.aseg_cerebral.white.matter.rh      1.045681
Length: 269, dtype: float64
</pre></div></div>
</div>
<p>Notably residualizing is far from perfect (imo garbage…), it is interesting though how the results change when we add the residualization. We can just ignore the issue for now, and explore some different pipelines (not residualizing anymore). We are going to just try some off the shelf default pipelines for simplicity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">BPt.default.pipelines</span> <span class="kn">import</span> <span class="n">pipelines</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipelines</span><span class="p">[</span><span class="s1">&#39;lgbm_pipe&#39;</span><span class="p">],</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac1011df4a7a4cb58ac0585c54a34ada", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;roc_auc&#39;: 0.8863269603808108}
std_scores = {&#39;roc_auc&#39;: 0.0027329159182744186}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;, &#39;fis_&#39;, &#39;feature_importances_&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;get_fis&#39;, &#39;get_feature_importances&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=16, problem_type=&#39;binary&#39;,
            scorer={&#39;roc_auc&#39;: make_scorer(roc_auc_score, needs_threshold=True)},
            subjects=&#39;all&#39;, target=&#39;sex&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pipelines</span><span class="p">[</span><span class="s1">&#39;lgbm_pipe&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Pipeline(steps=[Imputer(obj=&#39;mean&#39;, scope=&#39;float&#39;),
                Imputer(obj=&#39;median&#39;, scope=&#39;category&#39;), Scaler(obj=&#39;robust&#39;),
                Transformer(obj=&#39;one hot encoder&#39;, scope=&#39;category&#39;),
                Model(obj=&#39;lgbm&#39;,
                      param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy()),
                                               n_iter=60),
                      params=1)])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># User cv=3 for runtime reasons</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">pipelines</span><span class="p">[</span><span class="s1">&#39;stacking_pipe&#39;</span><span class="p">],</span>
                      <span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
                      <span class="n">problem_spec</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9c0795fae4dd4b83b87c0ba432c119fa", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BPtEvaluator
------------
mean_scores = {&#39;roc_auc&#39;: 0.8589750730819228}
std_scores = {&#39;roc_auc&#39;: 0.003731209094578198}

Saved Attributes: [&#39;estimators&#39;, &#39;preds&#39;, &#39;timing&#39;, &#39;train_subjects&#39;, &#39;val_subjects&#39;, &#39;feat_names&#39;, &#39;ps&#39;, &#39;mean_scores&#39;, &#39;std_scores&#39;, &#39;weighted_mean_scores&#39;, &#39;scores&#39;]

Avaliable Methods: [&#39;get_preds_dfs&#39;, &#39;permutation_importance&#39;]

Evaluated with:
ProblemSpec(n_jobs=16, problem_type=&#39;binary&#39;,
            scorer={&#39;roc_auc&#39;: make_scorer(roc_auc_score, needs_threshold=True)},
            subjects=&#39;all&#39;, target=&#39;sex&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pipelines</span><span class="p">[</span><span class="s1">&#39;stacking_pipe&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Pipeline(steps=[Imputer(obj=&#39;mean&#39;, scope=&#39;float&#39;),
                Imputer(obj=&#39;median&#39;, scope=&#39;category&#39;), Scaler(obj=&#39;robust&#39;),
                Transformer(obj=&#39;one hot encoder&#39;, scope=&#39;category&#39;),
                Ensemble(base_model=Model(obj=&#39;ridge&#39;,
                                          param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy()),
                                                                   n_iter=60),
                                          params=1),
                         models=[Model(obj=&#39;elastic&#39;,
                                       param_search=ParamSearch(cv=CV(cv_strategy=CVS...
                                       param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy()),
                                                                n_iter=60),
                                       params=1),
                                 Model(obj=Pipeline(param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy()),
                                                                             n_iter=60),
                                                    steps=[FeatSelector(obj=&#39;univariate &#39;
                                                                            &#39;selection&#39;,
                                                                        params=2),
                                                           Model(obj=&#39;svm&#39;,
                                                                 params=1)])),
                                 Model(obj=&#39;lgbm&#39;,
                                       param_search=ParamSearch(cv=CV(cv_strategy=CVStrategy()),
                                                                n_iter=60),
                                       params=1)],
                         n_jobs_type=&#39;models&#39;, obj=&#39;stacking&#39;)])
</pre></div></div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="waist_cm.html" title="previous page">Predict Waist Circumference with Diffusion Weighted Imaging</a>
    <a class='right-next' id="next-link" href="../reference/index.html" title="next page">API reference</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020-2021.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>